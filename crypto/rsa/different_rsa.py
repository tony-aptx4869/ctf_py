#!/usr/bin/python3
# -*- coding: UTF-8 -*-

from Crypto.Util.number import *

def rsa_get_euler(prime1, prime2):
    return (prime1 - 1) * (prime2 - 1)

# 求私钥
def rsa_get_d(e, euler):
    return inverse(e, euler)

# # 求私钥
# def rsa_get_key(e, euler):
#     k = 1
#     while True:
#         if (((euler * k) + 1) % e) == 0:
#             return (euler * k + 1) // e
#         k += 1

def rsa_decode_with_c_d_n(c, d, n):
    m = pow(c, d, n)
    return long_to_bytes(m).decode()


if __name__ == '__main__':
    e = 65537
    c = 138722104762718976032857543651302886170525056001602716592141625658383767408264093262113709786172260615555996824567753811925695638669238386234708645111182134152464933217287541979019228159209984811628294038739751454086109950975209948197495743396777388273820349686335919516697411693046624095769703128469202211516688026123295211158531470647815841245920170011729185862667469966554776861242160654743541992847193786005787832285852281200524417632476356867636882769996990816521121318348035380840645933533359522382048945407964867136581334110211703327209265704187688598700074911726675767052882649582734149920164476354819772572
    n = 15293032452367350153165488019040591774681947461806846211394110253205642263473409036704430501788674488200851282278984725917912759352314609076680106465146927987185897175378916654731151435950320195255522494291583988536029296991596619423707257925682257185042246028065776839633921182038513220548394723908052221984662464436997205150633282305927029392525099540708495780571249882489695973963632971183382777042356347551064066905696276285731788272303683511385482977782637450227421451201918293810767333044827440010656954584157537245294463744706911890881303916957823546888317663596809518986423759580164973515874335313890183844107
    p_add_q = 247692304124525245667211985038807577149526498494620587227372131956797094691024123744042981854305983726197861602632106839535018310683933498643676609810589875918586417866386869064768090338701012890559718753173049383323496502184441436691424048763065870187602889642817121344647370355274568061468019226498216956532
    # p*q = n, euler = (p-1)*(q-1) = p*q-(p+q)+1 = n-(p+q)+1
    euler = n - p_add_q + 1
    d = rsa_get_d(e, euler)
    decoded = rsa_decode_with_c_d_n(c, d, n)
    print(decoded)
    
